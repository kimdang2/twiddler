<!DOCTYPE html>
<html>
  <head>
    <script src="jquery.js"></script>
    <script src="data_generator.js"></script>
    <script src="https://momentjs.com/downloads/moment.js"></script>
    <link rel="stylesheet" href="main.css">
  </head>
  <body>
    <div class = "container">
      <h1 class ="title"> Twiddler</h1>
      <button class='btn'>New Tweet</button>
      <div class="newsfeed"></div>
    </div>

    <script>
      $(document).ready(function(){
        //displays a new tweet with message, user, and time each traversal

        var displayTweets = function(tweetsCollection) {
          var index = 5;
          while(index >= 0){
            var tweet = streams.home[index]; // array of tweets
            var $tweet = $('<div class=tweet></div>');
            var $user = $('<div class=user></div>');
            var $message = $('<div class=message></div>');
            var $dateTime = $('<span class=dateTime></span>');

            $tweet.appendTo(".newsfeed")
            $user.html('<a href="#' + tweet.user + '">'
              + tweet.user + '</a> '+ ' ~ ' + moment(tweet.created_at).fromNow()).prependTo($tweet);
            $message.html('<i>"</i>'+ tweet.message+ '<i>"</i>').appendTo($tweet);

            index -= 1;
          }
        }
        displayTweets(streams.home);

        //button to display one new tweet
        var $button = $(".btn");
        $button.click(function (){
          generateOneRandomTweet();
        });

        // generates one new random tweet
        var generateOneRandomTweet = function(){
          var index = Math.floor(Math.random() * streams.home.length);
          var counter = 0;
          while(counter >= 0){
            var tweet = streams.home[index]; // array of tweets
            var $tweet = $('<div class=tweet></div>');
            var $user = $('<div class=user></div>');
            var $message = $('<div class=message></div>');

            $tweet.prependTo('.newsfeed')
            $user.html('<a href="#' + tweet.user + '">'
              + tweet.user + '</a> '+ ' ~ ' + moment(tweet.created_at).fromNow()).prependTo($tweet);
            $message.html('<i>"</i>'+ tweet.message+ '<i>"</i>').appendTo($tweet);
            counter -= 1;
          }
          clearTimeline();
        }

        //clears timeline when username is clicked

        var clearTimeline = function() {$("a[href^='#']" ).on('click', function(event) {
            event.preventDefault(); // cancels event
            var username = event.target.text;
            $('.container').html(''); // clears container div containing tweets
            var $timeline = $('<div class=newsfeed><h2>'+ username + 'Timeline</h2></div>').appendTo('body');
            usersTweets(username);
          });
        }
        clearTimeline();

        //timeline
        var usersTweets = function(username) {
          var index = 5;
          while(index >= 0){
            var tweet = streams.home[index]; // array of tweets
            var $tweet = $('<div class=tweet></div>');
            var $user = $('<div class=user></div>');
            var $message = $('<div class=message></div>');
            var $dateTime = $('<span class=dateTime></span>');

            $tweet.appendTo(".newsfeed")
            $user.html('<a href="#' + username + '">'
              + username + '</a> '+ ' ~ ' + moment(tweet.created_at).fromNow()).prependTo($tweet);
            $message.html('<i>"</i>'+ tweet.message+ '<i>"</i>').appendTo($tweet);

            index -= 1;
          }
        }

      });//end of document.ready function
    </script>


  </body>
</html>
