<!DOCTYPE html>
<html>
  <head>
    <script src="jquery.js"></script>
    <script src="data_generator.js"></script>
    <script src="https://momentjs.com/downloads/moment.js"></script>
    <script src="https://kit.fontawesome.com/128037f178.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="main.css">
    <title> Home / Twiddler</title>
    <link rel="icon" href="images/twitter-logo.png" type="image/icon type">
  </head>
  <body>
    <div class = "container">
      <h1 class ="title"> <i class="fab fa-twitter"></i> Twiddler</h1>
      <input class = 'tweet' id = "input" placeholder="What's happening?">
      <div id ="btn">
        <button class='btn-tweet'> <i class="fab fa-twitter"></i> View Tweet Pending ... (1)</button>
        <input id = "guestName" placeholder="Enter Guest Name">
        <button class='btn-submit-tweet' id = "btn-submit-tweet"><i class="fab fa-twitter"></i> Submit Tweet</button>
      </div>
      <div class="newsfeed"></div>
    </div>

    <script>
      $(document).ready(function(user){
        //displays a new tweet with message, user, and time each traversal
        var displayTweets = function() {
          var index = 3;
          while(index >= 0){
            var tweet = streams.home[index];
            var $tweet = $('<div class=tweet></div>');
            var $user = $('<div class=user></div>');
            var $message = $('<div class=message></div>');
            var $dateTime = $('<span class=dateTime></span>');
            var $icons = $('<div class=icons></div>');

            $tweet.appendTo(".newsfeed")
            $user.html('<a href="#' + tweet.user + '">@'
              + tweet.user + '</a> '+ ' ~ ' + moment(tweet.created_at).fromNow()).prependTo($tweet);
            $message.html('<i>"</i>'+ tweet.message+ '<i>"</i>').appendTo($tweet);
            $icons.html('<i id="icon-img" class="far fa-comment">17</i>' + '<i id="icon-img" class="fas fa-retweet"> 5</i>' + '<i id="icon-img" class="far fa-heart"> 1238 </i>' + '<i id="icon-img" class="far fa-bookmark"></i>').appendTo($tweet);
            index -= 1;
          }
        }
        displayTweets();


        // When clicked, button will display one new tweet
        $(".btn-tweet").click(function (){
          generateOneRandomTweet();
        });

        // When username name is clicked, displays user's timeline and changes title bar to username
        var clearTimeline = function() {
            $("a").on('click', function(event) {
              event.preventDefault();
              var username = this.getAttribute('href').slice(1);

              $('.container').html('');
              $('title').text('@' + username + ' / Twiddler');

              var $bio = $('<div class=bio></div>');
              var $timeline = $('<div class=newsfeed><h3>'+ username + '</h3></div>').appendTo('.container');

              $bio.html('@' + username + '<br>I like to watch anime<br> <span><i class="fa fa-calendar" aria-hidden="true"></i> Joined September 2009 </span><br> <b>198</b> <span>Following</span> <b>297</b> <span>Followers</span>').appendTo($timeline);

              usersTweets(username);
          });
        }

        // generates one new random tweet
        var generateOneRandomTweet = function(){
          var index = Math.floor(Math.random() * streams.home.length);
          var counter = 0;
          while(counter >= 0){
            var tweet = streams.home[index]; // array of tweets
            var $tweet = $('<div class=tweet></div>');
            var $user = $('<div class=user></div>');
            var $message = $('<div class=message></div>');
            var $icons = $('<div class=icons></div>');

            $tweet.prependTo(".newsfeed")
            $user.html('<a href="#' + tweet.user + '">@'
              + tweet.user + '</a> '+ ' ~ ' + moment(tweet.created_at).fromNow()).prependTo($tweet);
            $message.html('<i>"</i>'+ tweet.message+ '<i>"</i>').appendTo($tweet);
            $icons.html('<i id="icon-img" class="far fa-comment">17</i>' + '<i id="icon-img" class="fas fa-retweet"> 5</i>' + '<i id="icon-img" class="far fa-heart"> 1238 </i>' + '<i id="icon-img" class="far fa-bookmark"></i>').appendTo($tweet);

            counter -= 1;
          }
          clearTimeline();
        }

        clearTimeline();

        //function displays user's timeline
        var usersTweets = function(username) {
          var index = 8;
          while(index >= 0){
            var tweet = streams.home[index];
            var $tweet = $('<div class=tweet></div>');
            var $user = $('<div class=user></div>');
            var $message = $('<div class=message></div>');
            var $dateTime = $('<span class=dateTime></span>');
            var $icons = $('<div class=icons></div>');

            $tweet.appendTo(".newsfeed")
            $user.html('<a href="#' + username + '">@'
              + username + '</a> '+ ' ~ ' + moment(tweet.created_at).fromNow()).prependTo($tweet);
            $message.html('<i>"</i>'+ tweet.message+ '<i>"</i>').appendTo($tweet);
            $icons.html('<i id="icon-img" class="far fa-comment">17</i>' + '<i id="icon-img" class="fas fa-retweet"> 5</i>' + '<i id="icon-img" class="far fa-heart"> 1238 </i>' + '<i id="icon-img" class="far fa-bookmark"></i>').appendTo($tweet);

            index -= 1;
          }
        }

        // allow users to tweet
        $("#btn-submit-tweet").click(function(){
          var $guestName = $("#guestName").val();
          var $input = $("#input").val();
          var $tweet = $('<div class=tweet></div>');
          var $user = $('<div class=user></div>');
          var $message = $('<div class=message></div>');
          var date = new Date().toString()
          var $icons = $('<div class=icons></div>');

          $tweet.prependTo('.newsfeed')
          $user.html('<a href="#' + $guestName + '">@'
              + $guestName + '</a> '+ ' ~ ' + moment(date).fromNow()).prependTo($tweet);
          $message.html('<i>"</i>'+ $input+ '<i>"</i>').appendTo($tweet);
          $icons.html('<i id="icon-img" class="far fa-comment">17</i>' + '<i id="icon-img" class="fas fa-retweet"> 5</i>' + '<i id="icon-img" class="far fa-heart"> 1238 </i>' + '<i id="icon-img" class="far fa-bookmark"></i>').appendTo($tweet);
          clearTimeline();
        });

      });
    </script>


  </body>
</html>
